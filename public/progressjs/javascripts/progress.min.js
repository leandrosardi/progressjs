progressJs = {
    // array of error reports
    myXhr: [],
    // start sequence of AJAX calls
    start: function(conf) {
        //console.log("asdasd");
        //document.getElementById("bar").style.width = 100 + "%";
        //document.getElementById("start").disabled = true;
        //document.getElementById("start").innerHTML = 'processing...';
        var length = conf['datas'].length;
        function submitData(j) {
            progressJs.total_calls++;
            var data = conf['datas'][j]
            //document.getElementById("start").innerHTML = 'processing...';
            var request = $.ajax({
                method: conf['type'],
                url: conf['url'],
                async: true,
                dataType: 'json',
                contentType: 'application/json',
                data: JSON.stringify({"hola":"123"}), //JSON.stringify(data),
                crossDomain: true,
                beforeSend: function(request) {
                    request.setRequestHeader("Content-Type", "application/json");
                    request.setRequestHeader("Accept", "application/json");
                },
                success: function(response) {
                    progressJs.success_calls++;
                    //console.log(response, new Date());
                    conf['success'](j, data, response);
                    // call the next request in the sequence
                    if (j+1 < length) { setTimeout(() => { submitData(j+1) }, conf.delay_between_calls); }
                },
                error: function(jqXHR, exception) {
                    //console.log("Error:  ", exception);
                    progressJs.error_calls++;
                    conf['error'](j, data, jqXHR);
                    // call the next request in the sequence
                    if (j+1 < length) { setTimeout(() => { submitData(j+1) }, conf.delay_between_calls); }
                },
            }).done(function(msg) {
                //console.log(msg, new Date());
                //document.getElementById("bar").style.width = 0 + "%";
            });
            progressJs.myXhr.push(request);
        }
        submitData(0);
        //document.getElementById("bar").style.width = 100 + "%";
        //document.getElementById("start").disabled = false;
        //document.getElementById("start").innerHTML = 'START';
    },

    cancel: function(handler) {
        handler.abort(handler);
    },

    count: function(handler) {
        return handler.length;
    },

    completed: function(handler = null) {
        var count = 0;
        $.each(handler, function(key, value) {
            if (value.status == 200)
                count++;
        });
        return count;
    },

    failed: function(handler) {
        var count = 0;
        $.each(handler, function(key, value) {
            if (value.status != 200)
                count++;
        });
        return count;
    },
};