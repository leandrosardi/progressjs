progressJs = {

    myXhr: [],

    start: function(myData) {

        //console.log("asdasd");
        document.getElementById("bar").style.width = 100 + "%";
        document.getElementById("start").disabled = true;
        document.getElementById("start").innerHTML = 'processing...';


        length = myData['datas'].length;

        result = JSON.stringify(myData['datas']);

        for (var k = 0; k < length; ++k) {

            //console.log("current ajax  ", myData['datas'][k])
            submitData(myData['datas'][k], length)
        }


        function submitData(data, j) {
            progressJs.total_calls++;

            document.getElementById("start").innerHTML = 'processing...';
            var request = $.ajax({
                method: myData['type'],
                url: myData['url'],
                async: false,

                crossDomain: true,
                beforeSend: function(request) {
                    request.setRequestHeader("Content-Type", "application/json");
                    request.setRequestHeader("Accept", "application/json");
                },
                success: function(result) {
                    progressJs.success_calls++;
                    //console.log(result, new Date());
                    myData['success'](length, result);
                },
                error: function(jqXHR, exception) {
                    //console.log("Error:  ", exception);
                    progressJs.error_calls++;

                    myData['error'](length, jqXHR);
                },

            }).done(function(msg) {
                //console.log(msg, new Date());
                document.getElementById("bar").style.width = 0 + "%";

            });

            progressJs.myXhr.push(request);

        }

        document.getElementById("bar").style.width = 100 + "%";
        document.getElementById("start").disabled = false;
        document.getElementById("start").innerHTML = 'START';
        return progressJs.myXhr;

    },

    cancel: function(handler) {
        handler.abort(handler);
    },

    count: function(handler) {
        return handler.length;
    },

    completed: function(handler = null) {
        var count = 0;
        $.each(handler, function(key, value) {
            if (value.status == 200)
                count++;
        });
        return count;
    },

    failed: function(handler) {

        var count = 0;
        $.each(handler, function(key, value) {
            if (value.status != 200)
                count++;
        });
        return count;
    },

};