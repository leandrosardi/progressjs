progressJs = {


total_calls: 0,
success_calls: 0,
error_calls: 0,
	// var success = 0;
	// var errorcall = 0;


    start: function(myData) {

	

    		//var ctx="<div class='progress progress-blue progress-striped'> <div class='bar' id='bar' style='width: 0%;'></div></div>";

       // var progressBar = document.getElementById("progress"),
            loadBtn = document.getElementById("start");
          //  display = document.getElementById("display");
       		//$("#start").after(ctx);

        var progressBar = document.getElementById("bar");
        progressBar.style.width = 0 + "%";
        progressBar.style.width = 100 + "%";


        loadBtn.disabled = true;
        loadBtn.innerHTML = 'processing';

        // window.setTimeout(function(){
        //            // do whatever you want to do 
        //            alert("hello");    
        //             }, 600);

        //upload(buildFormData());
        // alert(myData['type']);
        // alert(myData['url']);

        length=myData['datas'].length;

        //alert(length);


        result = JSON.stringify(myData['datas']);
        // alert(result)
       //console.log("total ajax calls made till noe  " ,progressJs.total)


        var xhr = new XMLHttpRequest();
        progressJs.total_calls++;
        xhr.onreadystatechange = function(oEvent) {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                	progressJs.success_calls++;
                	console.log("total ajax calls success till noe  " ,progressJs.success_calls)
                    myData['success'](result, xhr);
                } else {
                	progressJs.error_calls++;
                    myData['error'](length, xhr);
                }
            }
        };

        xhr.open(myData['type'], myData['url'], true);
        // if (xhr.upload) 
        {
            console.log("here ");

            xhr.onprogress = function(e) {
                console.log("here 11 ", e);


                if (e.lengthComputable) {
                    progressBar.max = e.total;
                    progressBar.value = e.loaded;
                  // display .innerText = Math.floor((e.loaded / e.total) * 100) + '%';

                    console.log("onprogress ", e.lengthComputable)

                    console.log("onprogress ", e.total)

                    console.log("onprogress ", e.loaded)

                }
            }
            xhr.onloadstart = function(e) {
                progressBar.value = 0;
              //  display.innerText = '0%';
                console.log("onloadstart", progressBar.value);

            }
            xhr.onloadend = function(e) {
                progressBar.value = e.loaded;
                loadBtn.disabled = false;
                loadBtn.innerHTML = 'START';
                console.log("onloadend ", e.loaded)

            }
        }
        xhr.send(result);
        loadBtn.disabled = false;
        loadBtn.innerHTML = 'Processing..';
        console.log("TEST 2");


        	return xhr;
    },

     cancel: function(handler) {
     	
     	handler.abort(handler);

    },

    count: function(handler=null) {
    	return progressJs.total_calls;

    },

    completed: function(handler=null) {
    	return progressJs.success_calls;


    },

    failed: function(handler) {

    	return progressJs.error_calls;

    },






};